<section class="transactions-section">
	<div class="container">
		<!-- Filters + Pagination (always visible) -->
		<div class="transactions-toolbar">
			<template x-if="$store.app.isMobile">
				{% include "app/components/dashboard/transaction_filters.html" %}
			</template>
		</div>

		<!-- Skeletons -->
		<div class="transactions-grid tx-skeleton"
		     x-show="isLoading && ($store.transactions.transactions?.length ?? 0) > 0"
		     x-transition.opacity>
			<template x-for="i in pageSize" :key="`skeleton-${i}`">
				<div class="card tx-card">
					<div class="card-content p-4">
						<div class="level media">
							<div class="level-left tx-card__left" style="flex: 1;">
								<div class="skeleton-line is-skeleton"
								     style="width: 30%; height: 0.8rem; margin-bottom: 0.5rem;"></div>
								<div class="skeleton-line is-skeleton"
								     style="width: 75%; height: 1rem;"></div>
							</div>
							<div class="level-right tx-card__right" style="min-width: 9rem;">
								<div class="skeleton-line is-skeleton"
								     style="width: 5.5rem; height: 1.2rem;"></div>
							</div>
						</div>
					</div>
				</div>
			</template>
		</div>

		<!-- Real content -->
		<div class="transactions-grid" x-show="!isLoading" x-transition.opacity>
			<!-- No transactions message -->
			<template x-if="paginatedTransactions.length === 0">
				<div class="notification tx-card"
				     style="font-size:1.06rem;display:flex; align-items:center; justify-content:center;">
					No transactions found.
				</div>
			</template>

			<!-- Transaction cards -->
			<template x-for="t in paginatedTransactions" :key="t.id">
				<div class="card mb-3 tx-card">
					<div class="card-content p-4">
						<div class="media">
							<!-- Left: Date + Description -->
							<div class="media-content">
								<div class="tx-card__meta has-text-grey" x-text="formatDate(t.date)"></div>
								<div class="tx-card__title" x-text="t.description || '(No description)'"
								     style="white-space: pre-line;"></div>
							</div>

							<!-- Right: Amount + Category -->
							<div class="media-right"
							     style="display:flex; flex-direction:column; align-items:flex-end; gap:0.25rem;">
								<!-- Category tag with category's color -->
								<span class="tag is-clickable"
								      :style="`
               color: ${$store.app.isDarkTheme ? '#fff' : '#000'};
               border: 1px solid ${t.category?.color || '#888'};`"
								      x-text="t.category?.name || 'Uncategorized'"
								@click="
	filters.category = (filters.category === (t.category?.id || ''))
		? ''
		: (t.category?.id || '');
">
                                </span>

								<p class="is-size-6 has-text-weight-semibold"
								   :class="t.is_income ? 'has-text-success' : 'has-text-danger'"
								   x-text="formatAmount(t.amount, t.currency || 'PLN')"></p>
							</div>
						</div>
					</div>
				</div>
			</template>

			<!-- Invisible fillers (only if there are transactions and fillerCount > 0) -->
			<template x-for="i in fillerCount" :key="`filler-${i}`">
				<div class="card tx-card tx-card--filler is-invisible"></div>
			</template>
		</div>

		<div class="transactions-toolbar">
			<template x-if="!$store.app.isMobile">
				{% include "app/components/dashboard/transaction_filters.html" %}
			</template>
		</div>
	</div>
</section>
