{% extends "app/base.html" %}

{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'app/css/dashboard/transaction_app.css' %}">
{% endblock %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<section class="section">
	<div x-data="transactionApp()" class="container">
		{% include "app/modals/add_transaction.html" %}

		<div class="transactions-header">
			<template x-if="$store.app.isMobile" x-cloak>
				{% include "app/components/dashboard/transaction_filters.html" %}
			</template>

			<!-- Left: Add Transaction -->
			<button class="button is-primary is-medium" @click="showTransactionModal = true">Add Transaction</button>

			<!-- Right: Balance -->
			<div class="balance-container">
				<div class="balance-title has-text-weight-bold">
					Balance
				</div>
				<div :style="`color: ${balance < 0 ? '#e74c3c' : '#2ecc71'}`">
			<span class="balance-value is-size-4"
			      x-text="balance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}) + '&nbsp;PLN'"></span>
				</div>
			</div>
		</div>

<!--		<hr style="margin-top: .6rem !important; margin-bottom: 0 !important;">-->


		{% include "app/components/dashboard/transaction_table.html" %}

		<!-- Chart -->
		<div x-data="chartApp()" style="max-width: 300px; margin: 2rem auto;">
			<canvas id="summaryChart"></canvas>
		</div>
	</div>
</section>

{% endblock %}

{% block extra_js %}
<script>
    window.csrf_token = "{{ csrf_token }}";
    window.initialTransactions = {{ transactions_json | safe }};
    window.initialCategories = {{ categories_json | safe }};
    window.transactionsApiUrl = "{% url 'transaction-list' %}";
    console.log("initialCategories:", window.initialCategories)
</script>
{% endblock %}
